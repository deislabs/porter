mixins:
- helm

name: mysql
version: 0.1.0
invocationImage: porter-mysql:latest

credentials:
- name: kubeconfig
  path: /root/.kube/config

parameters:
- name: database_name
  type: string
  default: mydb

install:
- description: "Install MySQL"
  helm:
    name: porter-ci-mysql
    chart: stable/mysql
    version: 0.10.2
    replace: true
    set:
      mysqlDatabase:
        source: bundle.parameters.database_name
  outputs:
  - name: mysql-password
    secret: porter-ci-mysql
    key: mysql-password
#- description: "foo"
#  exec:
#    command: printf
#    args:
#      - "password %s:"
#      - source: bundle.outputs.mysql-password

uninstall:
- description: "Uninstall MySQL"
  helm:
    name: porter-ci-mysql
    purge: true
